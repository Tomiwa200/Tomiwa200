<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body {
            text-align: center;
        }

        .location, .desc , .c, .circle, .f{
            padding: 7px;
        }

        button {
            box-shadow: 0 3px 3px;
            text-transform: uppercase;
        }
    </style>
    <title>Get Weather</title>
</head>
<body   style="background-color: rgb(124, 58, 58);">


    <h1>Weather Condition</h1>
    <div class="container">
        <img src="" srcset="" alt="" id="weather-icon">
        <div id="location">No information available</div>
        <div class="desc">Unable to fetch weather</div>
        <div class="weather">
            <div class="c">celcius</div>
            <div class="circle"></div>
            <div class="f">fahreheit</div>
            <div class="p">pressure</div>
        </div>
        <div class="info">
            <h4>Sunrise: <span class="sunrise">No info available</span> </h4>
            <h4>Sunset: <span class="sunset">No info available</span></h4>
        </div>

    </div>
    
    <button onclick="loadWeather()">Get Info</button>





    <script>
        
       
        window.addEventListener( 'load',  () => {
        
            const iconImg = document.getElementById('weather-icon');
                    const loc = document.querySelector('#location');
                    const tempC = document.querySelector('.c') ;
                    const tempF= document.querySelector('.f') ;
                    const press= document.querySelector('.p') ;
                    const desc = document.querySelector('.desc');
                    const sunriseDOM = document.querySelector('.sunrise');
                    const sunsetDOM = document.querySelector('.sunset');
        
           let lat;
           let long;
           //accessing user's geolocation
           if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition((position) => {
                      lat= position.coords.latitude;
                      long = position.coords.longitude;
                
            
             const base =  `https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${long}&appid=a23786c66869f6a34431e4fd96bacfcc&units=metric`;
                fetch(base).then ((response) => {
                    return response.json();
                })

                .then ((data) => {
                    console.log(data);
                   
                const {temp, pressure} = data.main;
                const place = data.name;
                const {description, icon} = data.weather[0];
                const {sunrise, sunset}  = data.sys;

                const iconUrl = `http://openweathermap.org/img/wn/${icon}@2x.png`;
                const fahreheit =  (temp*9)/5+32;


                const sunriseGMT = new Date(sunrise*1000);
                const sunsetGMT = new Date(sunset*1000);

                //display of data in DOM
                     
                iconImg.src = iconUrl;
                loc.textContent = `${place}`;
                desc.textContent = `${description}`;
                tempC.textContent = `${temp.toFixed(2)} °C`;
                tempF.textContent = `${fahreheit.toFixed(2)} °F`;
                press.textContent = `${pressure}  N/㎡ `;
                sunriseDOM.textContent = `${sunriseGMT.toLocaleDateString()}, ${sunriseGMT.toLocaleTimeString()}`;
                sunsetDOM.textContent = `${sunsetGMT.toLocaleDateString()}, ${sunsetGMT.toLocaleTimeString()}`;
                
                localStorage.setItem('data' , JSON.stringify(data));

                });
              });  
            }
        });



    </script>
</body>
</html>